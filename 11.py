import time
from functools import reduce
import requests
import json
import re


def reply_view(lang_id_list):
    url = "https://clubajax.autohome.com.cn/topic/rv?fun=jsonprv&callback=jsonprv&ids={ids}&r={timeid}+GMT%2B0800+(%E4%B8%AD%E5%9B%BD%E6%A0%87%E5%87%86%E6%97%B6%E9%97%B4)&callback=jsonprv&_={time_chuo}"
    param_id = [i + "%2C" for i in lang_id_list]
    ids = reduce(lambda x, y: x + y, param_id)
    ctim = time.asctime(time.localtime(time.time())).split()
    ctim[-2],ctim[-1] = ctim[-1],ctim[-2]
    ctim[-1] = "%3A".join(ctim[-1].split(":"))
    timeid = "+".join(ctim)
    time_chuo = str(int(time.time()*1000))
    revi_url = url.format(ids=ids,timeid = timeid,time_chuo = timeid)
    return revi_url
def get_test():
    url = "https://clubajax.autohome.com.cn/topic/rv?fun=jsonprv&callback=jsonprv&ids=67500580%2C66728314%2C67252775%2C49224928%2C59652118%2C67704220%2C67492447%2C67475606%2C67703735%2C67824311%2C66728314%2C67799799%2C67751547%2C67501619%2C67646960%2C67815938%2C67252775%2C67810914%2C67760163%2C67805139%2C67798439%2C66786884%2C67493257%2C67669719%2C67698292%2C67500580%2C66143778%2C67678617%2C67670463%2C67721613%2C67642621%2C65399114%2C66131288%2C67613838%2C64868560%2C67751149%2C67640671%2C67742569%2C67476191%2C67780372%2C67772863%2C67633221%2C67791848%2C65148084%2C66069641%2C67634220%2C67784900%2C67392020%2C67677245%2C67728811%2C67711122%2C67700360%2C67425403%2C66971303%2C67482326%2C67566988%2C67545906%2C67652205%2C66499426%2C66837224%2C67178202%2C67678044%2C67721401%2C63338808%2C67704504%2C67572209%2C67572102%2C67557371%2C66998881%2C66993540%2C67683326%2C40016609%2C67275565%2C67583356%2C67136121%2C67100979%2C67505173%2C67689635%2C66499389%2C66854138%2C67352930%2C67407419%2C66525181%2C67555059%2C67484296%2C67675596%2C66825686%2C66931589%2C67652902%2C67232838%2C67656746%2C67649548%2C67634084%2C66681877%2C67342455%2C67424429%2C67451610%2C67639387%2C67591449%2C64146971%2C50645981%2C67479189%2C67511887%2C67013151%2C67414181%2C&r=Thu+Apr+5+2018+15%3A50%3A52+GMT%2B0800+"
    r = requests.get(url)
    a = eval(re.findall(r'onprv(.*?)$',r.text)[0])
    return a
if __name__ == '__main__':
    get_test()
